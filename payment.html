<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Connect Brilliance</title>

        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>

        <script src="https://js.braintreegateway.com/v2/braintree.js"></script>
        <script src="components/webcomponentsjs/webcomponents.js"></script>

        <link rel="import" href="components/polymer/polymer.html">
        <link rel="import" href="components/paper-input/paper-input.html">
        <link rel="import" href="components/paper-button/paper-button.html">
        <link rel="import" href="components/paper-checkbox/paper-checkbox.html">
        <link rel="import" href="menus/mindropdown.html">
        <link rel="import" href="menus/navtoolbar.html">
        <link rel="stylesheet" type="text/css" href="style.css">

    </head>
    <body unresolved>
        
        <menu-navtoolbar title="Payment"></menu-navtoolbar>
        <div class="container">

        <div id="main">
            <h2>How Long Would You Like To Charge?</h2>
            <h3>Please select a duration in minutes</h3>
            <p>Minutes 
                <select id="calc">
                    <option selected="selected">0</option>    
                    <option value="10">10</option>
                    <option value="15">15</option>
                    <option value="20">20</option>
                    <option value="25">25</option>
                    <option value="30">30</option>
                    <option value="35">35</option>    
                    <option value="40">40</option>
                    <option value="45">45</option>
                    <option value="50">50</option>
                    <option value="55">55</option>
                    <option value="60">60</option>
                </select>
            </p>
            
            <min-dropdown></min-dropdown>

            <paper-button raised id="price" class="btn">Calculate Price</paper-button>

            Price: &#36; <span id="output"></span>
            <br><br>

            <button id="continue" class="btn1">Continue</button>
            <paper-button raised >Continue</paper-button>

        </div>

        <form id="checkout" action="/checkout.html" hidden>
            <div id="dropin"></div>
            <input type="submit" id="submission" value="Pay $0">
        </form>
        </div>

        <script>
            var token = '';
            $(function(){
                console.log('ajaxing');
                $.ajax({
                    type: "POST",
                    url: "http://127.0.0.1:51006/braintree",
                    data: {}
                })
                .success(function(msg) {
                    token = msg['token'];
                    console.log(token);
                    braintree.setup(
                        token,
                        'dropin', {
                        container: 'dropin'
                    });
                });
            });
        </script>
        <script>
            braintree.setup(
                "eyJ2ZXJzaW9uIjoyLCJhdXRob3JpemF0aW9uRmluZ2VycHJpbnQiOiI2ZjRjYmZkNDIxZmFiYjgwN2M2YWY2MGQzNDkwMzQxZmU3MTM3MmIyZmNmYTM3NjQzOTMzM2FiMGZkZmQ0OTE2fGNyZWF0ZWRfYXQ9MjAxNS0wMS0zMVQyMzo0NjoyMC41MDM0MzE5NTYrMDAwMFx1MDAyNm1lcmNoYW50X2lkPXY2cGtrZnNwYjYyZnljbjdcdTAwMjZwdWJsaWNfa2V5PWI0Z2d6Mmd0bTRteXY4bmsiLCJjb25maWdVcmwiOiJodHRwczovL2FwaS5zYW5kYm94LmJyYWludHJlZWdhdGV3YXkuY29tOjQ0My9tZXJjaGFudHMvdjZwa2tmc3BiNjJmeWNuNy9jbGllbnRfYXBpL3YxL2NvbmZpZ3VyYXRpb24iLCJjaGFsbGVuZ2VzIjpbImN2diJdLCJwYXltZW50QXBwcyI6W10sImNsaWVudEFwaVVybCI6Imh0dHBzOi8vYXBpLnNhbmRib3guYnJhaW50cmVlZ2F0ZXdheS5jb206NDQzL21lcmNoYW50cy92NnBra2ZzcGI2MmZ5Y243L2NsaWVudF9hcGkiLCJhc3NldHNVcmwiOiJodHRwczovL2Fzc2V0cy5icmFpbnRyZWVnYXRld2F5LmNvbSIsImF1dGhVcmwiOiJodHRwczovL2F1dGgudmVubW8uc2FuZGJveC5icmFpbnRyZWVnYXRld2F5LmNvbSIsImFuYWx5dGljcyI6eyJ1cmwiOiJodHRwczovL2NsaWVudC1hbmFseXRpY3Muc2FuZGJveC5icmFpbnRyZWVnYXRld2F5LmNvbSJ9LCJ0aHJlZURTZWN1cmVFbmFibGVkIjp0cnVlLCJ0aHJlZURTZWN1cmUiOnsibG9va3VwVXJsIjoiaHR0cHM6Ly9hcGkuc2FuZGJveC5icmFpbnRyZWVnYXRld2F5LmNvbTo0NDMvbWVyY2hhbnRzL3Y2cGtrZnNwYjYyZnljbjcvdGhyZWVfZF9zZWN1cmUvbG9va3VwIn0sInBheXBhbEVuYWJsZWQiOnRydWUsInBheXBhbCI6eyJkaXNwbGF5TmFtZSI6ImJhdHRsZWhhY2syMDE1ISEhISIsImNsaWVudElkIjpudWxsLCJwcml2YWN5VXJsIjoiaHR0cDovL2V4YW1wbGUuY29tL3BwIiwidXNlckFncmVlbWVudFVybCI6Imh0dHA6Ly9leGFtcGxlLmNvbS90b3MiLCJiYXNlVXJsIjoiaHR0cHM6Ly9hc3NldHMuYnJhaW50cmVlZ2F0ZXdheS5jb20iLCJhc3NldHNVcmwiOiJodHRwczovL2NoZWNrb3V0LnBheXBhbC5jb20iLCJkaXJlY3RCYXNlVXJsIjpudWxsLCJhbGxvd0h0dHAiOnRydWUsImVudmlyb25tZW50Tm9OZXR3b3JrIjp0cnVlLCJlbnZpcm9ubWVudCI6Im9mZmxpbmUiLCJ1bnZldHRlZE1lcmNoYW50IjpmYWxzZSwibWVyY2hhbnRBY2NvdW50SWQiOiJrbjJuZ3B0emR0M2NqcHM4IiwiY3VycmVuY3lJc29Db2RlIjoiVVNEIn0sImNvaW5iYXNlRW5hYmxlZCI6ZmFsc2UsIm1lcmNoYW50SWQiOiJ2NnBra2ZzcGI2MmZ5Y243IiwidmVubW8iOiJvZmYifQ==",
                'dropin', {
                container: 'dropin'
            });
        </script>
        <script>
            var flag = false;

            var price = document.getElementById('price');
            price.onclick = calcPrice;

            var continueBtn = document.getElementById('continue');
            continueBtn.onclick = braintree;

            function pricing() {
                var Price = 0.1;
                var calc = document.getElementById("calc");
                var value = document.getElementById("calc").value;
                var result = value * Price;
                return result;
            }

            function calcPrice() {
                var result = pricing();
                document.getElementById("output").innerHTML = result;
                document.getElementById("submission").value = "Pay $" + result;
                flag = true;
            }

            function braintree() {
                if (flag) {
                    document.getElementById("checkout").removeAttribute('hidden');
                }
            }

        </script>
    </body>
</html>